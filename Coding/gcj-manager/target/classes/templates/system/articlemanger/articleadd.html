<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="renderer" content="webkit" />
    <title>添加管理员</title>
    <link rel="stylesheet" href="/system/css/pintuer.css" />
    <link rel="stylesheet" href="/system/css/admin.css" />
    <script src="/system/js/jquery.js"></script>
    <script src="/system/js/pintuer.js"></script>  
    <script th:src="@{/system/kindeditor/kindeditor-min.js}" charset="utf-8"></script>
	<script th:src="@{/system/kindeditor/lang/zh_CN.js}" charset="utf-8"></script>
</head>
<body>
<div class="panel admin-panel margin-top">
  <div class="panel-head" id="add"><strong><span class="icon-pencil-square-o"></span>添加文章</strong></div>
  <div class="body-content">
    <form method="post" class="form-x" action="/system/addArticle" id="addArticleForm" th:inline="text" >   
      <input type="hidden" name="id"  value="" />  
      <div class="form-group">
        <div class="label">
          <label>文章标题：</label>
        </div>
        <div class="field">
          <input id="articleTitle" type="text" class="input w50" name="article_title" value="" data-validate="required:请输入文章标题" />         

          <div class="tips"></div>
        </div>
      </div>
        <div class="form-group">
            <div class="label">
                <label>文章副标题：</label>
            </div>
            <div class="field">
                <input type="text" class="input w50" name="article_subtitle" value="" />
                <div class="tips"></div>
            </div>
        </div>
        
      <div class="form-group">
        <div class="label">
          <label>排序：</label>
        </div>
        <div class="field">
          <input type="text" class="input w50" name="article_sort" value="" data-validate="required:请输入顺序" />         
          <div class="tips"></div>
        </div>
      </div>
     
      <div class="form-group">
        <div class="label">
          <label>文章类型：</label>
        </div>
        <div class="field">
           <select class="select w50" name="article_type" >
          	<option th:each="articleType:${articleClassList}" th:value="${articleType.ac_id}" >
          		[[${articleType.ac_name}]]
          	</option>
          </select>
          <div class="tips"></div>
        </div>
      </div>
      
      <div class="form-group">
        <div class="label">
          <label>文章内容：</label>
        </div>
        <div class="field">
          <textarea id="article_content" name="article_content" style="width:700px;height:300px;visibility:hidden;"></textarea>
          <div class="tips"></div>
        </div>
      </div>
    
     <div class="form-group">
        <div class="label">
          <label>是否显示：</label>
        </div>
        <div class="field">
          <div class="button-group radio">
          
          <label class="button active">
         	  <span class="icon icon-check"></span>          
              <input name="article_isshow" value="0" type="radio" checked="checked" />是             
          </label>             
        
          <label class="button active"><span class="icon icon-check"></span>          	
              <input name="article_isshow" value="1"  type="radio" checked="checked" />否
          </label>         
           </div>       
        </div>
     </div>
     <div class="form-group">
        <div class="label">
          <label></label>
        </div>
        <div class="field">
          <button class="button bg-main icon-check-square-o" type="button" id ="btnSubmit"> 提交</button>
        </div>
      </div>
    </form>
  </div>
</div>

<script type="text/javascript">

 	$("#btnSubmit").click(function(){
 		var value = $("#articleTitle").val();
		var reg = /^\s+$/g
		if (value == null || value.length == 0 || value=="" || reg.test(value)) {
			alert("输入内容不能为空");
			return;
		}
 		var data = $("#addArticleForm").serializeArray();
 		var ydMangerSystemArticle = {};
		$.each(data, function(k, v) {
			ydMangerSystemArticle[ v["name"] ] = v["value"];
		});
 		
 		$.ajax({
 			url: "/system/addArticle",
 			data: $("#addArticleForm").serialize(),
 			type: "post",
 			success: function(datas) {
 				if(datas.msg==true){
 					alert("添加成功");
					location.reload();
 				}else{
 					alert("添加失败");
 				}
 			}
 		});
 	});
 	
 	  var KE;
 	  KindEditor.ready(function(K) {
 	        KE = K.create("textarea[name='article_content']", {
 							items : ['source', '|', 'fullscreen', 'undo', 'redo', 'print', 'cut', 'copy', 'paste',
 	            'plainpaste', 'wordpaste', '|', 'justifyleft', 'justifycenter', 'justifyright',
 	            'justifyfull', 'insertorderedlist', 'insertunorderedlist', 'indent', 'outdent', 'subscript',
 	            'superscript', '|', 'selectall', 'clearhtml','quickformat','|',
 	            'formatblock', 'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold',
 	            'italic', 'underline', 'strikethrough', 'lineheight', 'removeformat', '|', 'image', 'table', 'hr', 'emoticons', 'link', 'unlink', '|', 'about'],
 							cssPath : "/system/kindeditor/themes/default/default.css",
 							uploadJson : '/system/fileUpload',  
 							fileManagerJson : '/system/fileManager',
 							allowImageUpload : true,
 							allowFlashUpload : false,
 							allowMediaUpload : false,
 							allowFileManager : false,
 							syncType:"form",
 							afterCreate : function() {
 								var self = this;
 								self.sync();
 							},
 							afterChange : function() {
 								var self = this;
 								self.sync();
 							},
 							afterBlur : function() {
 								var self = this;
 								self.sync();
 							}
 	        });
 				KE.appendHtml = function(id,val) {
 					this.html(this.html() + val);
 					if (this.isCreated) {
 						var cmd = this.cmd;
 						cmd.range.selectNodeContents(cmd.doc.body).collapse(false);
 						cmd.select();
 					}
 					return this;
 				}
 		});   
	
</script>
</body></html>