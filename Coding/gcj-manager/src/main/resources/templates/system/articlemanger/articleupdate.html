<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="renderer" content="webkit" />
    <title>修改文章信息</title>
    <link rel="stylesheet" href="/system/css/pintuer.css" />
    <link rel="stylesheet" href="/system/css/admin.css" />
    <script src="/system/js/jquery.js"></script>
    <script src="/system/js/pintuer.js"></script>
    <script th:src="@{/system/kindeditor/kindeditor-min.js}" charset="utf-8"></script>
	<script th:src="@{/system/kindeditor/lang/zh_CN.js}" charset="utf-8"></script>  
</head>
<body th:inline="text">
<div class="panel admin-panel margin-top">
  <div class="panel-head" id="add"><strong><span class="icon-pencil-square-o"></span>修改文章信息</strong></div>
  <div class="body-content">
    <form method="post" class="form-x"  th:inline="text" id="updateForm" >   
       <input type="hidden" name="article_id"  th:value="${ydMangerArticle.article_id}" />   
        <div class="form-group">
            <div class="label">
                <label>文章标题：</label>
            </div>
            <div class="field">
                <input type="text" class="input w50" name="article_title" th:value="${ydMangerArticle.article_title}" />
                <div class="tips"></div>
            </div>
        </div>
      
      <div class="form-group">
        <div class="label">
          <label>文章副标题：</label>
        </div>
        <div class="field">																
          <input type="text" class="input w50" name="article_subtitle" th:value="${ydMangerArticle.article_subtitle}" />
          <div class="tips"></div>
        </div>
      </div>
      
      <div class="form-group">
        <div class="label">
          <label>文章类型：</label>
        </div>
        <div class="field">	
        	<select class="select w50" name="article_type"  >
          	<option th:each="articleType:${articleClassList}" th:value="${articleType.ac_id}" th:selected="${articleType.ac_id==ydMangerArticle.article_type? 'selected' : 'false'}" >
          		[[${articleType.ac_name}]]
          	</option>
          </select>															
          <div class="tips"></div>
        </div>
      </div>
      
      <div class="form-group">
        <div class="label">
          <label>文章内容：</label>
        </div>
        <div class="field">																
          <textarea id="article_content" name="article_content" style="width:700px;height:300px;visibility:hidden;">[[${ydMangerArticle.article_content}]]</textarea>
          <div class="tips"></div>
        </div>
      </div>
      
      <div class="form-group">
        <div class="label">
          <label>是否被显示：</label>
        </div>
        <div class="field">
          <div class="button-group radio">
          
          <label th:class="'button '+ ${ydMangerArticle.article_isshow eq 0 ? 'active' : ''} ">
         	  <span class="icon icon-check"></span>             
              <input name="article_isshow" value="0" type="radio" th:checked="${ydMangerArticle.article_isshow eq 0 ? 'true' : 'false'}" />是             
          </label>             
        
          <label th:class=" 'button '+ ${ydMangerArticle.article_isshow eq 1 ? 'active' : ''} ">
          <span class="icon icon-times"></span>          	
              <input name="article_isshow" value="1"  type="radio" th:checked="${ydMangerArticle.article_isshow eq 1 ? 'true' : 'false'}" />否
          </label>         
           </div>       
        </div>
     </div>
      
      <div class="form-group">
        <div class="label">
          <label></label>
        </div>
        <div class="field">
          <button class="button bg-main icon-check-square-o" type="button" id="btnSubmit"> 提交</button>
        </div>
      </div>
    </form>
  </div>
</div>
<script type="text/javascript">

//ajax提交表单
$("#btnSubmit").click(function(){
		var data = $("#updateForm").serializeArray();
		var ydMangerSystemAdmin = {};
	$.each(data, function(k, v) {
		ydMangerSystemAdmin[ v["name"] ] = v["value"];
	});
		
		$.ajax({
			url: "/system/updateArticle",
			data: $("#updateForm").serialize(),
			type: "post",
			success: function(datas) {
				if(datas.msg==true){
					alert("修改成功");
					location.reload();
				}else{
					alert("修改失败");
				}
			}
		});
	});	

var KE;
KindEditor.ready(function(K) {
      KE = K.create("textarea[name='article_content']", {
						items : ['source', '|', 'fullscreen', 'undo', 'redo', 'print', 'cut', 'copy', 'paste',
          'plainpaste', 'wordpaste', '|', 'justifyleft', 'justifycenter', 'justifyright',
          'justifyfull', 'insertorderedlist', 'insertunorderedlist', 'indent', 'outdent', 'subscript',
          'superscript', '|', 'selectall', 'clearhtml','quickformat','|',
          'formatblock', 'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold',
          'italic', 'underline', 'strikethrough', 'lineheight', 'removeformat', '|', 'image', 'table', 'hr', 'emoticons', 'link', 'unlink', '|', 'about'],
						cssPath : "js/kindeditor/themes/default/default.css",
						allowImageUpload : true,
						allowFlashUpload : false,
						allowMediaUpload : false,
						allowFileManager : false,
						syncType:"form",
						afterCreate : function() {
							var self = this;
							self.sync();
						},
						afterChange : function() {
							var self = this;
							self.sync();
						},
						afterBlur : function() {
							var self = this;
							self.sync();
						}
      });
			KE.appendHtml = function(id,val) {
				this.html(this.html() + val);
				if (this.isCreated) {
					var cmd = this.cmd;
					cmd.range.selectNodeContents(cmd.doc.body).collapse(false);
					cmd.select();
				}
				return this;
			}
	});
</script>
</body></html>