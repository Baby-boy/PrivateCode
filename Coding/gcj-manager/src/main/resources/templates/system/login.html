<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="renderer" content="webkit" />
    <title>登录</title>  
    <link rel="stylesheet" href="/system/css/pintuer.css" />
    <link rel="stylesheet" href="/system/css/admin.css" />
    <script src="/system/js/jquery.js"></script>
    <script src="/system/js/pintuer.js"></script>  
</head>
<body>
<div class="bg"></div>
<div class="container">
    <div class="line bouncein">
        <div class="xs6 xm4 xs3-move xm4-move">
            <div style="height:150px;"></div>
            <div class="media media-y margin-big-bottom">           
            </div>         
            <form action="/system/login" method="post" id = "loginForm" >
            <div class="panel loginbox" style="width:393px;margin: 0 auto;">
                <div class="text-center margin-big padding-big-top"><h1>功城记后台管理中心</h1></div>
                <div class="panel-body" style="padding:30px; padding-bottom:10px; padding-top:10px;">
                    <div class="form-group">
                        <div class="field field-icon-right">
                            <input type="text" class="input input-big" name="admin_account" placeholder="登录账号" data-validate="required:请填写账号" />
                            <span class="icon icon-user margin-small"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="field field-icon-right">
                            <input type="password" class="input input-big" name="admin_password" placeholder="登录密码" data-validate="required:请填写密码" />
                            <span class="icon icon-key margin-small"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="field">
                            <input type="text" class="input input-big" name="code" placeholder="填写右侧的验证码" data-validate="required:请填写右侧的验证码" />
<!--                            <img src="images/passcode.jpg" alt="" width="100" height="32" class="passcode" style="height:43px;cursor:pointer;" onclick="this.src=this.src+'?'" /> -->
                           <img id="imgObj" src="/code" alt="验证码" width="100" height="32" class="passcode" style="height:43px;cursor:pointer;" onclick="changeImg()" />   
                        </div>
                    </div>
                </div>
                <div style="padding:30px;"><button class="button button-block bg-main text-big input-big" type="button" id="btnSubmit" >登录</button></div>
            </div>
            </form>          
        </div>
    </div>
</div>
<script type="text/javascript">

 	$("#btnSubmit").click(function(){
 		var data = $("#loginForm").serializeArray();
 		var ydMangerSystemAdmin = {};
		$.each(data, function(k, v) {
			ydMangerSystemAdmin[ v["name"] ] = v["value"];
		});
 		
 		$.ajax({
 			url: "/system/login",
 			data: $("#loginForm").serialize(),
 			type: "post",
 			success: function(datas) {
 				if(datas.msg==200){
//  					alert("登录成功");
 					window.location.href="index";
 				};
 				if(datas.msg==300){
 					alert("账号或者密码错误 ");
 				};
 				if(datas.msg==100){
 					alert("账号或者密码不能为空");
 				};
 				if(datas.msg==400){
 					alert("验证码不能为空");
 				};
				if(datas.msg==500){
					alert("输入的验证码不正确");
 				};
 			}
 		});
 	});
 	
 	function changeImg() {
		var imgSrc = $("#imgObj");
		var src = imgSrc.attr("src");
		imgSrc.attr("src", chgUrl(src));
	}
	//时间戳   
	//为了使每次生成图片不一致，即不让浏览器读缓存，所以需要加上时间戳   
	function chgUrl(url) {
		var timestamp = (new Date()).valueOf();
		url = url.substring(0, 17);
		if ((url.indexOf(" &amp;")>= 0)) {
			url = url + "×tamp=" + timestamp;
		} else {
			url = url + "?timestamp=" + timestamp;
		}
		return url;
	}
</script>
</body>
</html>